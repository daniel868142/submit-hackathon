(self.webpackChunkui_react=self.webpackChunkui_react||[]).push([[9569],{96366:(e,t,r)=>{var a=r(3832);r(97116),r(49563),r(15764),e.exports=a.kem=a.kem||{};var n=a.jsbn.BigInteger;function s(e,t,r,n){e.generate=function(e,s){for(var o=new a.util.ByteBuffer,i=Math.ceil(s/n)+r,c=new a.util.ByteBuffer,l=r;l<i;++l){c.putInt32(l),t.start(),t.update(e+c.getBytes());var p=t.digest();o.putBytes(p.getBytes(n))}return o.truncate(o.length()-s),o.getBytes()}}a.kem.rsa={},a.kem.rsa.create=function(e,t){var r=(t=t||{}).prng||a.random,s={encrypt:function(t,s){var o,i=Math.ceil(t.n.bitLength()/8);do{o=new n(a.util.bytesToHex(r.getBytesSync(i)),16).mod(t.n)}while(o.compareTo(n.ONE)<=0);var c=i-(o=a.util.hexToBytes(o.toString(16))).length;return c>0&&(o=a.util.fillString(String.fromCharCode(0),c)+o),{encapsulation:t.encrypt(o,"NONE"),key:e.generate(o,s)}},decrypt:function(t,r,a){var n=t.decrypt(r,"NONE");return e.generate(n,a)}};return s},a.kem.kdf1=function(e,t){s(this,e,0,t||e.digestLength)},a.kem.kdf2=function(e,t){s(this,e,1,t||e.digestLength)}},84145:(e,t,r)=>{var a=r(3832);r(97116),e.exports=a.log=a.log||{},a.log.levels=["none","error","warning","info","debug","verbose","max"];var n={},s=[],o=null;a.log.LEVEL_LOCKED=2,a.log.NO_LEVEL_CHECK=4,a.log.INTERPOLATE=8;for(var i=0;i<a.log.levels.length;++i){var c=a.log.levels[i];n[c]={index:i,name:c.toUpperCase()}}a.log.logMessage=function(e){for(var t=n[e.level].index,r=0;r<s.length;++r){var o=s[r];if(o.flags&a.log.NO_LEVEL_CHECK)o.f(e);else t<=n[o.level].index&&o.f(o,e)}},a.log.prepareStandard=function(e){"standard"in e||(e.standard=n[e.level].name+" ["+e.category+"] "+e.message)},a.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]||0),e.full=a.util.format.apply(this,t)}},a.log.prepareStandardFull=function(e){"standardFull"in e||(a.log.prepareStandard(e),e.standardFull=e.standard)};var l=["error","warning","info","debug","verbose"];for(i=0;i<l.length;++i)!function(e){a.log[e]=function(t,r){var n=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:e,category:t,message:r,arguments:n};a.log.logMessage(s)}}(l[i]);if(a.log.makeLogger=function(e){var t={flags:0,f:e};return a.log.setLevel(t,"none"),t},a.log.setLevel=function(e,t){var r=!1;if(e&&!(e.flags&a.log.LEVEL_LOCKED))for(var n=0;n<a.log.levels.length;++n){if(t==a.log.levels[n]){e.level=t,r=!0;break}}return r},a.log.lock=function(e,t){void 0===t||t?e.flags|=a.log.LEVEL_LOCKED:e.flags&=~a.log.LEVEL_LOCKED},a.log.addLogger=function(e){s.push(e)},"undefined"!=typeof console&&"log"in console){var p;if(console.error&&console.warn&&console.info&&console.debug){var d={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},u=function(e,t){a.log.prepareStandard(t);var r=d[t.level],n=[t.standard];n=n.concat(t.arguments.slice()),r.apply(console,n)};p=a.log.makeLogger(u)}else{u=function(e,t){a.log.prepareStandardFull(t)};p=a.log.makeLogger(u)}a.log.setLevel(p,"debug"),a.log.addLogger(p),o=p}else console={log:function(){}};if(null!==o&&"undefined"!=typeof window&&window.location){var y=new URL(window.location.href).searchParams;if(y.has("console.level")&&a.log.setLevel(o,y.get("console.level").slice(-1)[0]),y.has("console.lock"))"true"==y.get("console.lock").slice(-1)[0]&&a.log.lock(o)}a.log.consoleLogger=o},43389:(e,t,r)=>{e.exports=r(28991),r(25063),r(137),r(41668),r(63219)},28991:(e,t,r)=>{var a=r(3832);e.exports=a.md=a.md||{},a.md.algorithms=a.md.algorithms||{}},25063:(e,t,r)=>{var a=r(3832);r(28991),r(97116);var n=e.exports=a.md5=a.md5||{};a.md.md5=a.md.algorithms.md5=n,n.create=function(){l||function(){s=String.fromCharCode(128),s+=a.util.fillString(String.fromCharCode(0),64),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],i=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],c=new Array(64);for(var e=0;e<64;++e)c[e]=Math.floor(4294967296*Math.abs(Math.sin(e+1)));l=!0}();var e=null,t=a.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var r=n.messageLengthSize/4,s=0;s<r;++s)n.fullMessageLength.push(0);return t=a.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n}};return n.start(),n.update=function(s,o){"utf8"===o&&(s=a.util.encodeUtf8(s));var i=s.length;n.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=i[1],i[1]=i[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,i[0]=i[1]/4294967296>>>0;return t.putBytes(s),p(e,r,t),(t.read>2048||0===t.length())&&t.compact(),n},n.digest=function(){var o=a.util.createBuffer();o.putBytes(t.bytes());var i=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize&n.blockLength-1;o.putBytes(s.substr(0,n.blockLength-i));for(var c,l=0,d=n.fullMessageLength.length-1;d>=0;--d)l=(c=8*n.fullMessageLength[d]+l)/4294967296>>>0,o.putInt32Le(c>>>0);var u={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};p(u,r,o);var y=a.util.createBuffer();return y.putInt32Le(u.h0),y.putInt32Le(u.h1),y.putInt32Le(u.h2),y.putInt32Le(u.h3),y},n};var s=null,o=null,i=null,c=null,l=!1;function p(e,t,r){for(var a,n,s,l,p,d,u,y=r.length();y>=64;){for(n=e.h0,s=e.h1,l=e.h2,p=e.h3,u=0;u<16;++u)t[u]=r.getInt32Le(),a=n+(p^s&(l^p))+c[u]+t[u],n=p,p=l,l=s,s+=a<<(d=i[u])|a>>>32-d;for(;u<32;++u)a=n+(l^p&(s^l))+c[u]+t[o[u]],n=p,p=l,l=s,s+=a<<(d=i[u])|a>>>32-d;for(;u<48;++u)a=n+(s^l^p)+c[u]+t[o[u]],n=p,p=l,l=s,s+=a<<(d=i[u])|a>>>32-d;for(;u<64;++u)a=n+(l^(s|~p))+c[u]+t[o[u]],n=p,p=l,l=s,s+=a<<(d=i[u])|a>>>32-d;e.h0=e.h0+n|0,e.h1=e.h1+s|0,e.h2=e.h2+l|0,e.h3=e.h3+p|0,y-=64}}},86971:(e,t,r)=>{var a=r(3832);r(83453),e.exports=a.mgf=a.mgf||{},a.mgf.mgf1=a.mgf1},83453:(e,t,r)=>{var a=r(3832);r(97116),a.mgf=a.mgf||{},(e.exports=a.mgf.mgf1=a.mgf1=a.mgf1||{}).create=function(e){return{generate:function(t,r){for(var n=new a.util.ByteBuffer,s=Math.ceil(r/e.digestLength),o=0;o<s;o++){var i=new a.util.ByteBuffer;i.putInt32(o),e.start(),e.update(t+i.getBytes()),n.putBuffer(e.digest())}return n.truncate(n.length()-r),n.getBytes()}}}},66270:(e,t,r)=>{var a=r(3832);a.pki=a.pki||{};var n=e.exports=a.pki.oids=a.oids=a.oids||{};function s(e,t){n[e]=t,n[t]=e}function o(e,t){n[e]=t}s("1.2.840.113549.1.1.1","rsaEncryption"),s("1.2.840.113549.1.1.4","md5WithRSAEncryption"),s("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),s("1.2.840.113549.1.1.7","RSAES-OAEP"),s("1.2.840.113549.1.1.8","mgf1"),s("1.2.840.113549.1.1.9","pSpecified"),s("1.2.840.113549.1.1.10","RSASSA-PSS"),s("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),s("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),s("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),s("1.3.101.112","EdDSA25519"),s("1.2.840.10040.4.3","dsa-with-sha1"),s("1.3.14.3.2.7","desCBC"),s("1.3.14.3.2.26","sha1"),s("1.3.14.3.2.29","sha1WithRSASignature"),s("2.16.840.1.101.3.4.2.1","sha256"),s("2.16.840.1.101.3.4.2.2","sha384"),s("2.16.840.1.101.3.4.2.3","sha512"),s("2.16.840.1.101.3.4.2.4","sha224"),s("2.16.840.1.101.3.4.2.5","sha512-224"),s("2.16.840.1.101.3.4.2.6","sha512-256"),s("1.2.840.113549.2.2","md2"),s("1.2.840.113549.2.5","md5"),s("1.2.840.113549.1.7.1","data"),s("1.2.840.113549.1.7.2","signedData"),s("1.2.840.113549.1.7.3","envelopedData"),s("1.2.840.113549.1.7.4","signedAndEnvelopedData"),s("1.2.840.113549.1.7.5","digestedData"),s("1.2.840.113549.1.7.6","encryptedData"),s("1.2.840.113549.1.9.1","emailAddress"),s("1.2.840.113549.1.9.2","unstructuredName"),s("1.2.840.113549.1.9.3","contentType"),s("1.2.840.113549.1.9.4","messageDigest"),s("1.2.840.113549.1.9.5","signingTime"),s("1.2.840.113549.1.9.6","counterSignature"),s("1.2.840.113549.1.9.7","challengePassword"),s("1.2.840.113549.1.9.8","unstructuredAddress"),s("1.2.840.113549.1.9.14","extensionRequest"),s("1.2.840.113549.1.9.20","friendlyName"),s("1.2.840.113549.1.9.21","localKeyId"),s("1.2.840.113549.1.9.22.1","x509Certificate"),s("1.2.840.113549.1.12.10.1.1","keyBag"),s("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),s("1.2.840.113549.1.12.10.1.3","certBag"),s("1.2.840.113549.1.12.10.1.4","crlBag"),s("1.2.840.113549.1.12.10.1.5","secretBag"),s("1.2.840.113549.1.12.10.1.6","safeContentsBag"),s("1.2.840.113549.1.5.13","pkcs5PBES2"),s("1.2.840.113549.1.5.12","pkcs5PBKDF2"),s("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),s("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),s("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),s("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),s("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),s("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),s("1.2.840.113549.2.7","hmacWithSHA1"),s("1.2.840.113549.2.8","hmacWithSHA224"),s("1.2.840.113549.2.9","hmacWithSHA256"),s("1.2.840.113549.2.10","hmacWithSHA384"),s("1.2.840.113549.2.11","hmacWithSHA512"),s("1.2.840.113549.3.7","des-EDE3-CBC"),s("2.16.840.1.101.3.4.1.2","aes128-CBC"),s("2.16.840.1.101.3.4.1.22","aes192-CBC"),s("2.16.840.1.101.3.4.1.42","aes256-CBC"),s("2.5.4.3","commonName"),s("2.5.4.4","surname"),s("2.5.4.5","serialNumber"),s("2.5.4.6","countryName"),s("2.5.4.7","localityName"),s("2.5.4.8","stateOrProvinceName"),s("2.5.4.9","streetAddress"),s("2.5.4.10","organizationName"),s("2.5.4.11","organizationalUnitName"),s("2.5.4.12","title"),s("2.5.4.13","description"),s("2.5.4.15","businessCategory"),s("2.5.4.17","postalCode"),s("2.5.4.42","givenName"),s("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),s("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),s("2.16.840.1.113730.1.1","nsCertType"),s("2.16.840.1.113730.1.13","nsComment"),o("2.5.29.1","authorityKeyIdentifier"),o("2.5.29.2","keyAttributes"),o("2.5.29.3","certificatePolicies"),o("2.5.29.4","keyUsageRestriction"),o("2.5.29.5","policyMapping"),o("2.5.29.6","subtreesConstraint"),o("2.5.29.7","subjectAltName"),o("2.5.29.8","issuerAltName"),o("2.5.29.9","subjectDirectoryAttributes"),o("2.5.29.10","basicConstraints"),o("2.5.29.11","nameConstraints"),o("2.5.29.12","policyConstraints"),o("2.5.29.13","basicConstraints"),s("2.5.29.14","subjectKeyIdentifier"),s("2.5.29.15","keyUsage"),o("2.5.29.16","privateKeyUsagePeriod"),s("2.5.29.17","subjectAltName"),s("2.5.29.18","issuerAltName"),s("2.5.29.19","basicConstraints"),o("2.5.29.20","cRLNumber"),o("2.5.29.21","cRLReason"),o("2.5.29.22","expirationDate"),o("2.5.29.23","instructionCode"),o("2.5.29.24","invalidityDate"),o("2.5.29.25","cRLDistributionPoints"),o("2.5.29.26","issuingDistributionPoint"),o("2.5.29.27","deltaCRLIndicator"),o("2.5.29.28","issuingDistributionPoint"),o("2.5.29.29","certificateIssuer"),o("2.5.29.30","nameConstraints"),s("2.5.29.31","cRLDistributionPoints"),s("2.5.29.32","certificatePolicies"),o("2.5.29.33","policyMappings"),o("2.5.29.34","policyConstraints"),s("2.5.29.35","authorityKeyIdentifier"),o("2.5.29.36","policyConstraints"),s("2.5.29.37","extKeyUsage"),o("2.5.29.46","freshestCRL"),o("2.5.29.54","inhibitAnyPolicy"),s("1.3.6.1.4.1.11129.2.4.2","timestampList"),s("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),s("1.3.6.1.5.5.7.3.1","serverAuth"),s("1.3.6.1.5.5.7.3.2","clientAuth"),s("1.3.6.1.5.5.7.3.3","codeSigning"),s("1.3.6.1.5.5.7.3.4","emailProtection"),s("1.3.6.1.5.5.7.3.8","timeStamping")},97450:(e,t,r)=>{var a=r(3832);if(r(8925),r(3068),r(33480),r(28991),r(66270),r(98960),r(26953),r(49563),r(69372),r(28095),r(97116),void 0===n)var n=a.jsbn.BigInteger;var s=a.asn1,o=a.pki=a.pki||{};e.exports=o.pbe=a.pbe=a.pbe||{};var i=o.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},l={name:"PBES2Algorithms",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},p={name:"pkcs-12PbeParams",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"iterations"}]};function d(e,t){return e.start().update(t).digest().getBytes()}function u(e){var t;if(e){if(!(t=o.oids[s.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return y(t)}function y(e){var t=a.md;switch(e){case"hmacWithSHA224":t=a.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}o.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n,c,l,p=a.random.getBytesSync(r.saltSize),d=r.count,u=s.integerToDer(d);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var C,E,g;switch(r.algorithm){case"aes128":n=16,C=16,E=i["aes128-CBC"],g=a.aes.createEncryptionCipher;break;case"aes192":n=24,C=16,E=i["aes192-CBC"],g=a.aes.createEncryptionCipher;break;case"aes256":n=32,C=16,E=i["aes256-CBC"],g=a.aes.createEncryptionCipher;break;case"des":n=8,C=8,E=i.desCBC,g=a.des.createEncryptionCipher;break;default:throw(I=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,I}var f="hmacWith"+r.prfAlgorithm.toUpperCase(),h=y(f),m=a.pkcs5.pbkdf2(t,p,d,n,h),S=a.random.getBytesSync(C);(v=g(m)).start(S),v.update(s.toDer(e)),v.finish(),l=v.output.getBytes();var T=function(e,t,r,n){var i=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==n&&i.value.push(s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,a.util.hexToBytes(r.toString(16))),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o.oids[n]).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]));return i}(p,u,n,f);c=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(i.pkcs5PBES2).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(i.pkcs5PBKDF2).getBytes()),T]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(E).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,S)])])])}else{var I;if("3des"!==r.algorithm)throw(I=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,I;n=24;var v,A=new a.util.ByteBuffer(p);m=o.pbe.generatePkcs12Key(t,A,1,d,n),S=o.pbe.generatePkcs12Key(t,A,2,d,n);(v=a.des.createEncryptionCipher(m)).start(S),v.update(s.toDer(e)),v.finish(),l=v.output.getBytes(),c=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(i["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,p),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,u.getBytes())])])}return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[c,s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,l)])},o.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!s.validate(e,c,n,i)){var l=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw l.errors=i,l}var p=s.derToOid(n.encryptionOid),d=o.pbe.getCipher(p,n.encryptionParams,t),u=a.util.createBuffer(n.encryptedData);return d.update(u),d.finish()&&(r=s.fromDer(d.output)),r},o.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:s.toDer(e).getBytes()};return a.pem.encode(r,{maxline:t})},o.encryptedPrivateKeyFromPem=function(e){var t=a.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return s.fromDer(t.body)},o.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var n=o.wrapRsaPrivateKey(o.privateKeyToAsn1(e));return n=o.encryptPrivateKeyInfo(n,t,r),o.encryptedPrivateKeyToPem(n)}var i,c,l,p;switch(r.algorithm){case"aes128":i="AES-128-CBC",l=16,c=a.random.getBytesSync(16),p=a.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",l=24,c=a.random.getBytesSync(16),p=a.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",l=32,c=a.random.getBytesSync(16),p=a.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",l=24,c=a.random.getBytesSync(8),p=a.des.createEncryptionCipher;break;case"des":i="DES-CBC",l=8,c=a.random.getBytesSync(8),p=a.des.createEncryptionCipher;break;default:var d=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw d.algorithm=r.algorithm,d}var u=p(a.pbe.opensslDeriveBytes(t,c.substr(0,8),l));u.start(c),u.update(s.toDer(o.privateKeyToAsn1(e))),u.finish();var y={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:a.util.bytesToHex(c).toUpperCase()},body:u.output.getBytes()};return a.pem.encode(y)},o.decryptRsaPrivateKey=function(e,t){var r=null,n=a.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==n.type&&"PRIVATE KEY"!==n.type&&"RSA PRIVATE KEY"!==n.type)throw(l=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=l,l;if(n.procType&&"ENCRYPTED"===n.procType.type){var i,c;switch(n.dekInfo.algorithm){case"DES-CBC":i=8,c=a.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,c=a.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,c=a.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,c=a.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,c=a.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,c=function(e){return a.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":i=8,c=function(e){return a.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":i=16,c=function(e){return a.rc2.createDecryptionCipher(e,128)};break;default:var l;throw(l=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".')).algorithm=n.dekInfo.algorithm,l}var p=a.util.hexToBytes(n.dekInfo.parameters),d=c(a.pbe.opensslDeriveBytes(t,p.substr(0,8),i));if(d.start(p),d.update(a.util.createBuffer(n.body)),!d.finish())return r;r=d.output.getBytes()}else r=n.body;return null!==(r="ENCRYPTED PRIVATE KEY"===n.type?o.decryptPrivateKeyInfo(s.fromDer(r),t):s.fromDer(r))&&(r=o.privateKeyFromAsn1(r)),r},o.pbe.generatePkcs12Key=function(e,t,r,n,s,o){var i,c;if(null==o){if(!("sha1"in a.md))throw new Error('"sha1" hash algorithm unavailable.');o=a.md.sha1.create()}var l=o.digestLength,p=o.blockLength,d=new a.util.ByteBuffer,u=new a.util.ByteBuffer;if(null!=e){for(c=0;c<e.length;c++)u.putInt16(e.charCodeAt(c));u.putInt16(0)}var y=u.length(),C=t.length(),E=new a.util.ByteBuffer;E.fillWithByte(r,p);var g=p*Math.ceil(C/p),f=new a.util.ByteBuffer;for(c=0;c<g;c++)f.putByte(t.at(c%C));var h=p*Math.ceil(y/p),m=new a.util.ByteBuffer;for(c=0;c<h;c++)m.putByte(u.at(c%y));var S=f;S.putBuffer(m);for(var T=Math.ceil(s/l),I=1;I<=T;I++){var v=new a.util.ByteBuffer;v.putBytes(E.bytes()),v.putBytes(S.bytes());for(var A=0;A<n;A++)o.start(),o.update(v.getBytes()),v=o.digest();var N=new a.util.ByteBuffer;for(c=0;c<p;c++)N.putByte(v.at(c%l));var R=Math.ceil(C/p)+Math.ceil(y/p),L=new a.util.ByteBuffer;for(i=0;i<R;i++){var U=new a.util.ByteBuffer(S.getBytes(p)),B=511;for(c=N.length()-1;c>=0;c--)B>>=8,B+=N.at(c)+U.at(c),U.setAt(c,255&B);L.putBuffer(U)}S=L,d.putBuffer(v)}return d.truncate(d.length()-s),d},o.pbe.getCipher=function(e,t,r){switch(e){case o.oids.pkcs5PBES2:return o.pbe.getCipherForPBES2(e,t,r);case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case o.oids["pbewithSHAAnd40BitRC2-CBC"]:return o.pbe.getCipherForPKCS12PBE(e,t,r);default:var a=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw a.oid=e,a.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],a}},o.pbe.getCipherForPBES2=function(e,t,r){var n,i={},c=[];if(!s.validate(t,l,i,c))throw(n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=c,n;if((e=s.derToOid(i.kdfOid))!==o.oids.pkcs5PBKDF2)throw(n=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,n.supportedOids=["pkcs5PBKDF2"],n;if((e=s.derToOid(i.encOid))!==o.oids["aes128-CBC"]&&e!==o.oids["aes192-CBC"]&&e!==o.oids["aes256-CBC"]&&e!==o.oids["des-EDE3-CBC"]&&e!==o.oids.desCBC)throw(n=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,n.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],n;var p,d,y=i.kdfSalt,C=a.util.createBuffer(i.kdfIterationCount);switch(C=C.getInt(C.length()<<3),o.oids[e]){case"aes128-CBC":p=16,d=a.aes.createDecryptionCipher;break;case"aes192-CBC":p=24,d=a.aes.createDecryptionCipher;break;case"aes256-CBC":p=32,d=a.aes.createDecryptionCipher;break;case"des-EDE3-CBC":p=24,d=a.des.createDecryptionCipher;break;case"desCBC":p=8,d=a.des.createDecryptionCipher}var E=u(i.prfOid),g=a.pkcs5.pbkdf2(r,y,C,p,E),f=i.encIv,h=d(g);return h.start(f),h},o.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!s.validate(t,p,n,i))throw(E=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=i,E;var c,l,d,y=a.util.createBuffer(n.salt),C=a.util.createBuffer(n.iterations);switch(C=C.getInt(C.length()<<3),e){case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,l=8,d=a.des.startDecrypting;break;case o.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,l=8,d=function(e,t){var r=a.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var E;throw(E=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,E}var g=u(n.prfOid),f=o.pbe.generatePkcs12Key(r,y,1,C,c,g);return g.start(),d(f,o.pbe.generatePkcs12Key(r,y,2,C,l,g))},o.pbe.opensslDeriveBytes=function(e,t,r,n){if(null==n){if(!("md5"in a.md))throw new Error('"md5" hash algorithm unavailable.');n=a.md.md5.create()}null===t&&(t="");for(var s=[d(n,e+t)],o=16,i=1;o<r;++i,o+=16)s.push(d(n,s[i-1]+e+t));return s.join("").substr(0,r)}},98960:(e,t,r)=>{var a=r(3832);r(36607),r(28991),r(97116);var n,s=a.pkcs5=a.pkcs5||{};a.util.isNodejs&&!a.options.usePureJavaScript&&(n=r(25819)),e.exports=a.pbkdf2=s.pbkdf2=function(e,t,r,s,o,i){if("function"==typeof o&&(i=o,o=null),a.util.isNodejs&&!a.options.usePureJavaScript&&n.pbkdf2&&(null===o||"object"!=typeof o)&&(n.pbkdf2Sync.length>4||!o||"sha1"===o))return"string"!=typeof o&&(o="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),i?4===n.pbkdf2Sync.length?n.pbkdf2(e,t,r,s,(function(e,t){if(e)return i(e);i(null,t.toString("binary"))})):n.pbkdf2(e,t,r,s,o,(function(e,t){if(e)return i(e);i(null,t.toString("binary"))})):4===n.pbkdf2Sync.length?n.pbkdf2Sync(e,t,r,s).toString("binary"):n.pbkdf2Sync(e,t,r,s,o).toString("binary");if(null==o&&(o="sha1"),"string"==typeof o){if(!(o in a.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=a.md[o].create()}var c=o.digestLength;if(s>4294967295*c){var l=new Error("Derived key is too long.");if(i)return i(l);throw l}var p=Math.ceil(s/c),d=s-(p-1)*c,u=a.hmac.create();u.start(o,e);var y,C,E,g="";if(!i){for(var f=1;f<=p;++f){u.start(null,null),u.update(t),u.update(a.util.int32ToBytes(f)),y=E=u.digest().getBytes();for(var h=2;h<=r;++h)u.start(null,null),u.update(E),C=u.digest().getBytes(),y=a.util.xorBytes(y,C,c),E=C;g+=f<p?y:y.substr(0,d)}return g}f=1;function m(){if(f>p)return i(null,g);u.start(null,null),u.update(t),u.update(a.util.int32ToBytes(f)),y=E=u.digest().getBytes(),h=2,S()}function S(){if(h<=r)return u.start(null,null),u.update(E),C=u.digest().getBytes(),y=a.util.xorBytes(y,C,c),E=C,++h,a.util.setImmediate(S);g+=f<p?y:y.substr(0,d),++f,m()}m()}},26953:(e,t,r)=>{var a=r(3832);r(97116);var n=e.exports=a.pem=a.pem||{};function s(e){for(var t=e.name+": ",r=[],a=function(e,t){return" "+t},n=0;n<e.values.length;++n)r.push(e.values[n].replace(/^(\S+\r\n)/,a));t+=r.join(",")+"\r\n";var s=0,o=-1;for(n=0;n<t.length;++n,++s)if(s>65&&-1!==o){var i=t[o];","===i?(++o,t=t.substr(0,o)+"\r\n "+t.substr(o)):t=t.substr(0,o)+"\r\n"+i+t.substr(o+1),s=n-o-1,o=-1,++n}else" "!==t[n]&&"\t"!==t[n]&&","!==t[n]||(o=n);return t}function o(e){return e.replace(/^\s+/,"")}n.encode=function(e,t){t=t||{};var r,n="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(n+=s(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(n+=s(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),n+=s(r)),e.headers)for(var o=0;o<e.headers.length;++o)n+=s(e.headers[o]);return e.procType&&(n+="\r\n"),n+=a.util.encode64(e.body,t.maxline||64)+"\r\n",n+="-----END "+e.type+"-----\r\n"},n.decode=function(e){for(var t,r=[],n=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,s=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/;t=n.exec(e);){var c=t[1];"NEW CERTIFICATE REQUEST"===c&&(c="CERTIFICATE REQUEST");var l={type:c,procType:null,contentDomain:null,dekInfo:null,headers:[],body:a.util.decode64(t[3])};if(r.push(l),t[2]){for(var p=t[2].split(i),d=0;t&&d<p.length;){for(var u=p[d].replace(/\s+$/,""),y=d+1;y<p.length;++y){var C=p[y];if(!/\s/.test(C[0]))break;u+=C,d=y}if(t=u.match(s)){for(var E={name:t[1],values:[]},g=t[2].split(","),f=0;f<g.length;++f)E.values.push(o(g[f]));if(l.procType)if(l.contentDomain||"Content-Domain"!==E.name)if(l.dekInfo||"DEK-Info"!==E.name)l.headers.push(E);else{if(0===E.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');l.dekInfo={algorithm:g[0],parameters:g[1]||null}}else l.contentDomain=g[0]||"";else{if("Proc-Type"!==E.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==E.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');l.procType={version:g[0],type:g[1]}}}++d}if("ENCRYPTED"===l.procType&&!l.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},18936:(e,t,r)=>{var a=r(3832);r(97116),r(49563),r(137);var n=e.exports=a.pkcs1=a.pkcs1||{};function s(e,t,r){r||(r=a.md.sha1.create());for(var n="",s=Math.ceil(t/r.digestLength),o=0;o<s;++o){var i=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o);r.start(),r.update(e+i),n+=r.digest().getBytes()}return n.substring(0,t)}n.encode_rsa_oaep=function(e,t,r){var n,o,i,c;"string"==typeof r?(n=r,o=arguments[3]||void 0,i=arguments[4]||void 0):r&&(n=r.label||void 0,o=r.seed||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),i?i.start():i=a.md.sha1.create(),c||(c=i);var l=Math.ceil(e.n.bitLength()/8),p=l-2*i.digestLength-2;if(t.length>p)throw(g=new Error("RSAES-OAEP input message length is too long.")).length=t.length,g.maxLength=p,g;n||(n=""),i.update(n,"raw");for(var d=i.digest(),u="",y=p-t.length,C=0;C<y;C++)u+="\0";var E=d.getBytes()+u+""+t;if(o){if(o.length!==i.digestLength){var g;throw(g=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=o.length,g.digestLength=i.digestLength,g}}else o=a.random.getBytes(i.digestLength);var f=s(o,l-i.digestLength-1,c),h=a.util.xorBytes(E,f,E.length),m=s(h,i.digestLength,c);return"\0"+a.util.xorBytes(o,m,o.length)+h},n.decode_rsa_oaep=function(e,t,r){var n,o,i;"string"==typeof r?(n=r,o=arguments[3]||void 0):r&&(n=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(i=r.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c)throw(f=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,f.expectedLength=c,f;if(void 0===o?o=a.md.sha1.create():o.start(),i||(i=o),c<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),o.update(n,"raw");for(var l=o.digest().getBytes(),p=t.charAt(0),d=t.substring(1,o.digestLength+1),u=t.substring(1+o.digestLength),y=s(u,o.digestLength,i),C=s(a.util.xorBytes(d,y,d.length),c-o.digestLength-1,i),E=a.util.xorBytes(u,C,u.length),g=E.substring(0,o.digestLength),f="\0"!==p,h=0;h<o.digestLength;++h)f|=l.charAt(h)!==g.charAt(h);for(var m=1,S=o.digestLength,T=o.digestLength;T<E.length;T++){var I=E.charCodeAt(T);f|=I&(m?65534:0),S+=m&=1&I^1}if(f||1!==E.charCodeAt(S))throw new Error("Invalid RSAES-OAEP padding.");return E.substring(S+1)}},55147:(e,t,r)=>{var a=r(3832);r(3068),r(36607),r(66270),r(95496),r(97450),r(49563),r(28095),r(137),r(97116),r(25414);var n=a.asn1,s=a.pki,o=e.exports=a.pkcs12=a.pkcs12||{},i={name:"ContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:n.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},c={name:"PFX",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},i,{name:"PFX.macData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:n.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},l={name:"SafeBag",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:n.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},p={name:"Attribute",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,capture:"values"}]},d={name:"CertBag",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:n.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:n.Class.UNIVERSAL,type:n.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function u(e,t,r,a){for(var n=[],s=0;s<e.length;s++)for(var o=0;o<e[s].safeBags.length;o++){var i=e[s].safeBags[o];void 0!==a&&i.type!==a||(null!==t?void 0!==i.attributes[t]&&i.attributes[t].indexOf(r)>=0&&n.push(i):n.push(i))}return n}function y(e){if(e.composed||e.constructed){for(var t=a.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function C(e,t){var r={},o=[];if(!n.validate(e,a.pkcs7.asn1.encryptedDataValidator,r,o))throw(i=new Error("Cannot read EncryptedContentInfo.")).errors=o,i;var i,c=n.derToOid(r.contentType);if(c!==s.oids.data)throw(i=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=c,i;c=n.derToOid(r.encAlgorithm);var l=s.pbe.getCipher(c,r.encParameter,t),p=y(r.encryptedContentAsn1),d=a.util.createBuffer(p.value);if(l.update(d),!l.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return l.output.getBytes()}function E(e,t,r){if(!t&&0===e.length)return[];if((e=n.fromDer(e,t)).tagClass!==n.Class.UNIVERSAL||e.type!==n.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var a=[],o=0;o<e.value.length;o++){var i=e.value[o],c={},p=[];if(!n.validate(i,l,c,p))throw(f=new Error("Cannot read SafeBag.")).errors=p,f;var u,y,C={type:n.derToOid(c.bagId),attributes:g(c.bagAttributes)};a.push(C);var E=c.bagValue.value[0];switch(C.type){case s.oids.pkcs8ShroudedKeyBag:if(null===(E=s.decryptPrivateKeyInfo(E,r)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case s.oids.keyBag:try{C.key=s.privateKeyFromAsn1(E)}catch(e){C.key=null,C.asn1=E}continue;case s.oids.certBag:u=d,y=function(){if(n.derToOid(c.certId)!==s.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=n.derToOid(c.certId),e}var r=n.fromDer(c.cert,t);try{C.cert=s.certificateFromAsn1(r,!0)}catch(e){C.cert=null,C.asn1=r}};break;default:var f;throw(f=new Error("Unsupported PKCS#12 SafeBag type.")).oid=C.type,f}if(void 0!==u&&!n.validate(E,u,c,p))throw(f=new Error("Cannot read PKCS#12 "+u.name)).errors=p,f;y()}return a}function g(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var a={},o=[];if(!n.validate(e[r],p,a,o)){var i=new Error("Cannot read PKCS#12 BagAttribute.");throw i.errors=o,i}var c=n.derToOid(a.oid);if(void 0!==s.oids[c]){t[s.oids[c]]=[];for(var l=0;l<a.values.length;++l)t[s.oids[c]].push(a.values[l].value)}}return t}o.pkcs12FromAsn1=function(e,t,r){"string"==typeof t?(r=t,t=!0):void 0===t&&(t=!0);var l={};if(!n.validate(e,c,l,[]))throw(p=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=p,p;var p,d={version:l.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=a.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=u(d.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=u(d.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=u(d.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return u(d.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return u(d.safeContents,"localKeyId",e,t)}};if(3!==l.version.charCodeAt(0))throw(p=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=l.version.charCodeAt(0),p;if(n.derToOid(l.contentType)!==s.oids.data)throw(p=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=n.derToOid(l.contentType),p;var g=l.content.value[0];if(g.tagClass!==n.Class.UNIVERSAL||g.type!==n.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(g=y(g),l.mac){var f=null,h=0,m=n.derToOid(l.macAlgorithm);switch(m){case s.oids.sha1:f=a.md.sha1.create(),h=20;break;case s.oids.sha256:f=a.md.sha256.create(),h=32;break;case s.oids.sha384:f=a.md.sha384.create(),h=48;break;case s.oids.sha512:f=a.md.sha512.create(),h=64;break;case s.oids.md5:f=a.md.md5.create(),h=16}if(null===f)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+m);var S=new a.util.ByteBuffer(l.macSalt),T="macIterations"in l?parseInt(a.util.bytesToHex(l.macIterations),16):1,I=o.generateKey(r,S,3,T,h,f),v=a.hmac.create();if(v.start(f,I),v.update(g.value),v.getMac().getBytes()!==l.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,t,r,a){if(t=n.fromDer(t,r),t.tagClass!==n.Class.UNIVERSAL||t.type!==n.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var o=0;o<t.value.length;o++){var c=t.value[o],l={},p=[];if(!n.validate(c,i,l,p))throw(f=new Error("Cannot read ContentInfo.")).errors=p,f;var d={encrypted:!1},u=null,g=l.content.value[0];switch(n.derToOid(l.contentType)){case s.oids.data:if(g.tagClass!==n.Class.UNIVERSAL||g.type!==n.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");u=y(g).value;break;case s.oids.encryptedData:u=C(g,a),d.encrypted=!0;break;default:var f;throw(f=new Error("Unsupported PKCS#12 contentType.")).contentType=n.derToOid(l.contentType),f}d.safeBags=E(u,r,a),e.safeContents.push(d)}}(d,g.value,t,r),d},o.toPkcs12Asn1=function(e,t,r,i){(i=i||{}).saltSize=i.saltSize||8,i.count=i.count||2048,i.algorithm=i.algorithm||i.encAlgorithm||"aes128","useMac"in i||(i.useMac=!0),"localKeyId"in i||(i.localKeyId=null),"generateLocalKeyId"in i||(i.generateLocalKeyId=!0);var c,l=i.localKeyId;if(null!==l)l=a.util.hexToBytes(l);else if(i.generateLocalKeyId)if(t){var p=a.util.isArray(t)?t[0]:t;"string"==typeof p&&(p=s.certificateFromPem(p)),(L=a.md.sha1.create()).update(n.toDer(s.certificateToAsn1(p)).getBytes()),l=L.digest().getBytes()}else l=a.random.getBytes(20);var d=[];null!==l&&d.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.localKeyId).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,l)])])),"friendlyName"in i&&d.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.friendlyName).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[n.create(n.Class.UNIVERSAL,n.Type.BMPSTRING,!1,i.friendlyName)])])),d.length>0&&(c=n.create(n.Class.UNIVERSAL,n.Type.SET,!0,d));var u=[],y=[];null!==t&&(y=a.util.isArray(t)?t:[t]);for(var C=[],E=0;E<y.length;++E){"string"==typeof(t=y[E])&&(t=s.certificateFromPem(t));var g=0===E?c:void 0,f=s.certificateToAsn1(t),h=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.certBag).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.x509Certificate).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,n.toDer(f).getBytes())])])]),g]);C.push(h)}if(C.length>0){var m=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,C),S=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.data).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,n.toDer(m).getBytes())])]);u.push(S)}var T=null;if(null!==e){var I=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));T=null===r?n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.keyBag).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[I]),c]):n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.pkcs8ShroudedKeyBag).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[s.encryptPrivateKeyInfo(I,r,i)]),c]);var v=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[T]),A=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.data).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,n.toDer(v).getBytes())])]);u.push(A)}var N,R=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,u);if(i.useMac){var L=a.md.sha1.create(),U=new a.util.ByteBuffer(a.random.getBytes(i.saltSize)),B=i.count,b=(e=o.generateKey(r,U,3,B,20),a.hmac.create());b.start(L,e),b.update(n.toDer(R).getBytes());var D=b.getMac();N=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.sha1).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,D.getBytes())]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,U.getBytes()),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(B).getBytes())])}return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(3).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.oids.data).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,n.toDer(R).getBytes())])]),N])},o.generateKey=a.pbe.generatePkcs12Key},79437:(e,t,r)=>{var a=r(3832);r(8925),r(3068),r(33480),r(66270),r(26953),r(95496),r(49563),r(97116),r(25414);var n=a.asn1,s=e.exports=a.pkcs7=a.pkcs7||{};function o(e){var t={},r=[];if(!n.validate(e,s.asn1.recipientInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw o.errors=r,o}return{version:t.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(t.issuer),serialNumber:a.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:n.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function i(e){for(var t,r=[],s=0;s<e.length;++s)r.push((t=e[s],n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(t.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:t.issuer}),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a.util.hexToBytes(t.serialNumber))]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(t.encryptedContent.algorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return r}function c(e){var t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:e.issuer}),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a.util.hexToBytes(e.serialNumber))]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.digestAlgorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.signatureAlgorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])),t.value.push(n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[]),s=0;s<e.unauthenticatedAttributes.length;++s){var o=e.unauthenticatedAttributes[s];r.values.push(l(o))}t.value.push(r)}return t}function l(e){var t;if(e.type===a.pki.oids.contentType)t=n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.value).getBytes());else if(e.type===a.pki.oids.messageDigest)t=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===a.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),s=new Date("2050-01-01T00:00:00Z"),o=e.value;if("string"==typeof o){var i=Date.parse(o);o=isNaN(i)?13===o.length?n.utcTimeToDate(o):n.generalizedTimeToDate(o):new Date(i)}t=o>=r&&o<s?n.create(n.Class.UNIVERSAL,n.Type.UTCTIME,!1,n.dateToUtcTime(o)):n.create(n.Class.UNIVERSAL,n.Type.GENERALIZEDTIME,!1,n.dateToGeneralizedTime(o))}return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.type).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[t])])}function p(e,t,r){var s={};if(!n.validate(t,r,s,[])){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw o.errors=o,o}if(n.derToOid(s.contentType)!==a.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(s.encryptedContent){var i="";if(a.util.isArray(s.encryptedContent))for(var c=0;c<s.encryptedContent.length;++c){if(s.encryptedContent[c].type!==n.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");i+=s.encryptedContent[c].value}else i=s.encryptedContent;e.encryptedContent={algorithm:n.derToOid(s.encAlgorithm),parameter:a.util.createBuffer(s.encParameter.value),content:a.util.createBuffer(i)}}if(s.content){i="";if(a.util.isArray(s.content))for(c=0;c<s.content.length;++c){if(s.content[c].type!==n.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");i+=s.content[c].value}else i=s.content;e.content=a.util.createBuffer(i)}return e.version=s.version.charCodeAt(0),e.rawCapture=s,s}function d(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:t=a.aes.createDecryptionCipher(e.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:t=a.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}s.messageFromPem=function(e){var t=a.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var o=n.fromDer(t.body);return s.messageFromAsn1(o)},s.messageToPem=function(e,t){var r={type:"PKCS7",body:n.toDer(e.toAsn1()).getBytes()};return a.pem.encode(r,{maxline:t})},s.messageFromAsn1=function(e){var t={},r=[];if(!n.validate(e,s.asn1.contentInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw o.errors=r,o}var i,c=n.derToOid(t.contentType);switch(c){case a.pki.oids.envelopedData:i=s.createEnvelopedData();break;case a.pki.oids.encryptedData:i=s.createEncryptedData();break;case a.pki.oids.signedData:i=s.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return i.fromAsn1(t.content.value[0]),i},s.createSignedData=function(){var e=null;return e={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(p(e,t,s.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,n=0;n<r.length;++n)e.certificates.push(a.pki.certificateFromAsn1(r[n]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(a.pki.certificateToAsn1(e.certificates[r]));var s=[],o=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&o.value[0].value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,t)),s.length>0&&o.value[0].value.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(n.create(n.Class.UNIVERSAL,n.Type.SET,!0,e.signerInfos)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.type).getBytes()),o])},addSigner:function(t){var r=t.issuer,n=t.serialNumber;if(t.certificate){var s=t.certificate;"string"==typeof s&&(s=a.pki.certificateFromPem(s)),r=s.issuer.attributes,n=s.serialNumber}var o=t.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof o&&(o=a.pki.privateKeyFromPem(o));var i=t.digestAlgorithm||a.pki.oids.sha1;switch(i){case a.pki.oids.sha1:case a.pki.oids.sha256:case a.pki.oids.sha384:case a.pki.oids.sha512:case a.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+i)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var l=!1,p=!1,d=0;d<c.length;++d){var u=c[d];if(l||u.type!==a.pki.oids.contentType){if(p||u.type!==a.pki.oids.messageDigest);else if(p=!0,l)break}else if(l=!0,p)break}if(!l||!p)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:r,serialNumber:n,digestAlgorithm:i,signatureAlgorithm:a.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(t){var r;(t=t||{},"object"!=typeof e.content||null===e.contentInfo)&&(e.contentInfo=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(a.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof a.util.ByteBuffer?r=e.content.bytes():"string"==typeof e.content&&(r=a.util.encodeUtf8(e.content)),t.detached?e.detachedContent=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,r):e.contentInfo.value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,r)]))));0!==e.signers.length&&function(t){var r;r=e.detachedContent?e.detachedContent:(r=e.contentInfo.value[1]).value[0];if(!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=n.derToOid(e.contentInfo.value[0].value),o=n.toDer(r);for(var i in o.getByte(),n.getBerValueLength(o),o=o.getBytes(),t)t[i].start().update(o);for(var p=new Date,d=0;d<e.signers.length;++d){var u=e.signers[d];if(0===u.authenticatedAttributes.length){if(s!==a.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{u.authenticatedAttributesAsn1=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var y=n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[]),C=0;C<u.authenticatedAttributes.length;++C){var E=u.authenticatedAttributes[C];E.type===a.pki.oids.messageDigest?E.value=t[u.digestAlgorithm].digest():E.type===a.pki.oids.signingTime&&(E.value||(E.value=p)),y.value.push(l(E)),u.authenticatedAttributesAsn1.value.push(l(E))}o=n.toDer(y).getBytes(),u.md.start().update(o)}u.signature=u.key.sign(u.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(c(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var s=e.signers[r];(o=s.digestAlgorithm)in t||(t[o]=a.md[a.pki.oids[o]].create()),0===s.authenticatedAttributes.length?s.md=t[o]:s.md=a.md[a.pki.oids[o]].create()}for(var o in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(o).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=a.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},s.createEncryptedData=function(){var e=null;return e={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(t){p(e,t,s.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),d(e)}}},s.createEnvelopedData=function(){var e=null;return e={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=p(e,t,s.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(o(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.type).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,i(e.recipients)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,(t=e.encryptedContent,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(a.pki.oids.data).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(t.algorithm).getBytes()),t.parameter?n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,a=0;a<e.recipients.length;++a){var n=e.recipients[a],s=n.issuer;if(n.serialNumber===t.serialNumber&&s.length===r.length){for(var o=!0,i=0;i<r.length;++i)if(s[i].type!==r[i].type||s[i].value!==r[i].value){o=!1;break}if(o)return n}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var n=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=a.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}d(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var n,s,o;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case a.pki.oids["aes128-CBC"]:n=16,s=16,o=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:n=24,s=16,o=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:n=32,s=16,o=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:n=24,s=8,o=a.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=a.util.createBuffer(a.random.getBytes(n));else if(t.length()!=n)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+n+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(s));var i=o(t);if(i.start(e.encryptedContent.parameter.copy()),i.update(e.content),!i.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=i.output}for(var c=0;c<e.recipients.length;++c){var l=e.recipients[c];if(void 0===l.encryptedContent.content){if(l.encryptedContent.algorithm!==a.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm);l.encryptedContent.content=l.encryptedContent.key.encrypt(e.encryptedContent.key.data)}}}}}},95496:(e,t,r)=>{var a=r(3832);r(3068),r(97116);var n=a.asn1,s=e.exports=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=a.pkcs7||{},a.pkcs7.asn1=s;var o={name:"ContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};s.contentInfoValidator=o;var i={name:"EncryptedContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};s.envelopedDataValidator={name:"EnvelopedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(i)},s.encryptedDataValidator={name:"EncryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"}].concat(i)};var c={name:"SignerInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};s.signedDataValidator={name:"SignedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},o,{name:"SignedData.Certificates",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},s.recipientInfoValidator={name:"RecipientInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}}]);